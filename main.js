!function(){var t={240:function(){}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,i),r.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";var t=i(240),e=i.n(t);const n={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error"},s={profileEditForm:document.forms["profile-form"],addCardForm:document.forms["card-form"],profileEditButton:document.querySelector("#profile-edit-button"),addCardButton:document.querySelector("#profile-add-button"),profileEditPopup:document.querySelector("#profile-edit-popup"),addCardPopup:document.querySelector("#add-card-popup"),picturePopup:document.querySelector("#picture-popup"),profileTitle:document.querySelector(".profile__title"),profileDescription:document.querySelector(".profile__description"),profileTitleInput:document.querySelector("#profile-title-input"),profileDescriptionInput:document.querySelector("#profile-description-input"),cardListEl:document.querySelector(".cards__list"),addCardTitleInput:document.querySelector("#add-card-title"),addCardUrlInput:document.querySelector("#add-card-url")};class r{constructor(t,e,i){let{name:n,link:s,_id:r,likes:o}=t;this._name=n,this._link=s,this._id=r,this._likes=o,this._cardSelector=e,this._handleImageClick=i}_createCardElement(){const t=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);return this._cardElement=t,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._trashButton=this._cardElement.querySelector(".card__trash-button"),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._likeCountEl=this._cardElement.querySelector(".card__like-count"),this._cardTitleEl.textContent=this._name,this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._setLikeState(),this._cardElement}_setLikeState(){this._likes.some((t=>"your-user-id"===t._id))?(this._likeButton.classList.add("card__like-button_active"),this._isLiked=!0):(this._likeButton.classList.remove("card__like-button_active"),this._isLiked=!1),this._likeCountEl.textContent=this._likes.length}_toggleLike(){this._isLiked?api.dislikeCard(this._id).then((t=>{this._likes=t.likes,this._setLikeState()})).catch((t=>console.error(`Error unliking card: ${t}`))):api.likeCard(this._id).then((t=>{this._likes=t.likes,this._setLikeState()})).catch((t=>console.error(`Error liking card: ${t}`)))}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._toggleLike()})),this._trashButton.addEventListener("click",(()=>handleDeleteCard(this._cardElement,this._id))),this._cardImageEl.addEventListener("click",(()=>this._handleImageClick(this._link,this._name)))}getView(){return this._createCardElement(),this._setEventListeners(),this._cardElement}}class o{constructor(t,e){this._settings=t,this._formElement=e,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1)}_checkInputValidity(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.validity.valid?(t.classList.remove(this._settings.inputErrorClass),e.textContent=""):(t.classList.add(this._settings.inputErrorClass),e.textContent=t.validationMessage)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}resetValidation(){this._inputList.forEach((t=>{const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._settings.inputErrorClass),e.textContent=""})),this._toggleButtonState()}disableButton(){this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0}}class l{constructor(t){this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close").addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",(t=>{t.target===this._popupElement&&this.close()}))}}class c extends l{constructor(t,e){super(t),this._handleFormSubmit=e,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputList=Array.from(this._formElement.querySelectorAll(".popup__input"))}_getInputValues(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._formElement.reset()}))}}const a=new(e())({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2844dc79-6340-476e-8bf6-ea55311716d1","Content-Type":"application/json"}}),{profileEditForm:d,addCardForm:u,profileEditButton:p,addCardButton:_,profileTitleInput:h,profileDescriptionInput:m}=s,E=new class{constructor(t){let{nameSelector:e,descriptionSelector:i}=t;this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(t){let{name:e,description:i}=t;this._nameElement.textContent=e,this._descriptionElement.textContent=i}}({nameSelector:".profile__title",descriptionSelector:".profile__description"});function f(t){return new r(t,"#card-template",S).getView()}const v=new class{constructor(t,e){let{items:i,renderer:n}=t;this._items=i,this._renderer=n,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}({renderer:t=>{const e=f(t);v.addItem(e)}},".cards__list");function S(t,e){y.open({name:e,link:t})}a.getUserInfo().then((t=>{E.setUserInfo({name:t.name,description:t.about})})).catch((t=>console.error("Error fetching user info:",t))),a.getInitialCards().then((t=>{t.forEach((t=>{const e=f(t);v.addItem(e)}))})).catch((t=>console.error("Error fetching cards:",t)));const k=new c("#profile-edit-popup",(t=>{a.updateUserInfo(t).then((t=>{E.setUserInfo({name:t.name,description:t.about}),k.close()})).catch((t=>console.error("Error updating profile:",t)))}));k.setEventListeners();const g=new c("#add-card-popup",(t=>{a.addCard(t).then((t=>{const e=f(t);v.addItem(e),g.close()})).catch((t=>console.error("Error adding card:",t)))}));g.setEventListeners();const y=new class extends l{constructor(t){super(t),this._imageElement=this._popupElement.querySelector(".popup__image"),this._captionElement=this._popupElement.querySelector(".popup__caption")}open(t){let{name:e,link:i}=t;this._imageElement.src=i,this._imageElement.alt=e,this._captionElement.textContent=e,super.open()}}("#picture-popup");y.setEventListeners();const L=new o(n,d),C=new o(n,u);L.enableValidation(),C.enableValidation(),p.addEventListener("click",(function(){const t=E.getUserInfo();h.value=t.name,m.value=t.description,L.resetValidation(),k.open()})),_.addEventListener("click",(()=>{g.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxJQUcvRDBGLEVBQXFCakQsb0JBR3JCLE1BQU13QyxFQUF1QixJR3JKZCxjQUE2QmpELEVBQzFDekUsV0FBQUEsQ0FBWTBFLEdBQ1ZZLE1BQU1aLEdBQ05sRSxLQUFLOEgsY0FBZ0I5SCxLQUFLbUUsY0FBY3hGLGNBQWMsaUJBQ3REcUIsS0FBSytILGdCQUFrQi9ILEtBQUttRSxjQUFjeEYsY0FBYyxrQkFDMUQsQ0FFQTJGLElBQUFBLENBQUk3RSxHQUFpQixJQUFoQixLQUFFRyxFQUFJLEtBQUVDLEdBQU1KLEVBQ2pCTyxLQUFLOEgsY0FBYzdHLElBQU1wQixFQUN6QkcsS0FBSzhILGNBQWM1RyxJQUFNdEIsRUFDekJJLEtBQUsrSCxnQkFBZ0IvRyxZQUFjcEIsRUFDbkNrRixNQUFNUixNQUNSLEdIeUk4QyxrQkFDaEQ0QyxFQUFxQnhDLG9CQUdyQixNQUFNc0QsRUFBdUIsSUFBSXZGLEVBQy9CekUsRUFDQU0sR0FFSTJKLEVBQW9CLElBQUl4RixFQUM1QnpFLEVBQ0FTLEdBSUZ1SixFQUFxQmpFLG1CQUNyQmtFLEVBQWtCbEUsbUJBR2xCckYsRUFBa0I0RCxpQkFBaUIsU0FuRW5DLFdBQ0UsTUFBTTRGLEVBQVd4QyxFQUFpQkssY0FDbEM3RyxFQUFrQmlHLE1BQVErQyxFQUFTdEksS0FDbkNULEVBQXdCZ0csTUFBUStDLEVBQVNsQyxZQUV6Q2dDLEVBQXFCaEUsa0JBQ3JCdUQsRUFBeUJqRCxNQUMzQixJQTZEQTFGLEVBQWMwRCxpQkFBaUIsU0FBUyxLQUN0Q3FGLEVBQXFCckQsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9wcmFjdGljdW0vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0ZnVuY3Rpb24oKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG5cdFx0ZnVuY3Rpb24oKSB7IHJldHVybiBtb2R1bGU7IH07XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBkZWZpbml0aW9uKSB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCIvLyBGb3JtIFZhbGlkYXRpb24gU2V0dGluZ3NcclxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxufTtcclxuXHJcbi8vIEluaXRpYWwgQ2FyZHNcclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vLyBFbGVtZW50IFNlbGVjdG9yc1xyXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xyXG4gIHByb2ZpbGVFZGl0Rm9ybTogZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl0sXHJcbiAgYWRkQ2FyZEZvcm06IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIiksXHJcbiAgYWRkQ2FyZEJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIiksXHJcbiAgcHJvZmlsZUVkaXRQb3B1cDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtcG9wdXBcIiksXHJcbiAgYWRkQ2FyZFBvcHVwOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLXBvcHVwXCIpLFxyXG4gIHBpY3R1cmVQb3B1cDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaWN0dXJlLXBvcHVwXCIpLFxyXG4gIHByb2ZpbGVUaXRsZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKSxcclxuICBwcm9maWxlRGVzY3JpcHRpb246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIiksXHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKSxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIpLFxyXG4gIGNhcmRMaXN0RWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIiksXHJcbiAgYWRkQ2FyZFRpdGxlSW5wdXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtdGl0bGVcIiksXHJcbiAgYWRkQ2FyZFVybElucHV0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLXVybFwiKSxcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rLCBfaWQsIGxpa2VzIH0sIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2lkID0gX2lkO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlczsgLy8gTGlzdCBvZiB1c2VycyB3aG8gbGlrZWQgdGhlIGNhcmRcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX2NyZWF0ZUNhcmRFbGVtZW50KCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQ7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9saWtlQ291bnRFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1jb3VudFwiKTsgLy8gQXNzdW1pbmcgdGhlcmXigJlzIGEgc3BhbiB0byBzaG93IGxpa2UgY291bnRcclxuXHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICAvLyBTZXQgdGhlIGluaXRpYWwgbGlrZSBzdGF0ZSBhbmQgY291bnRcclxuICAgIHRoaXMuX3NldExpa2VTdGF0ZSgpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIHRoZSBjYXJkIGlzIGxpa2VkIGFuZCB1cGRhdGUgdGhlIGhlYXJ0IGljb25cclxuICBfc2V0TGlrZVN0YXRlKCkge1xyXG4gICAgY29uc3QgdXNlckxpa2VkID0gdGhpcy5fbGlrZXMuc29tZSgodXNlcikgPT4gdXNlci5faWQgPT09IFwieW91ci11c2VyLWlkXCIpOyAvLyBSZXBsYWNlIFwieW91ci11c2VyLWlkXCIgd2l0aCB0aGUgYWN0dWFsIHVzZXIgSURcclxuICAgIGlmICh1c2VyTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpOyAvLyBDaGFuZ2UgaGVhcnQgY29sb3JcclxuICAgICAgdGhpcy5faXNMaWtlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICAgIHRoaXMuX2lzTGlrZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMuX2xpa2VDb3VudEVsLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUxpa2UoKSB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICBhcGlcclxuICAgICAgICAuZGlzbGlrZUNhcmQodGhpcy5faWQpIC8vIFVubGlrZSB0aGUgY2FyZFxyXG4gICAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5fbGlrZXMgPSB1cGRhdGVkQ2FyZC5saWtlczsgLy8gVXBkYXRlIHRoZSBsaWtlcyBhcnJheVxyXG4gICAgICAgICAgdGhpcy5fc2V0TGlrZVN0YXRlKCk7IC8vIFVwZGF0ZSBVSSBiYXNlZCBvbiB0aGUgbmV3IGxpa2Ugc3RhdHVzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgRXJyb3IgdW5saWtpbmcgY2FyZDogJHtlcnJ9YCkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXBpXHJcbiAgICAgICAgLmxpa2VDYXJkKHRoaXMuX2lkKSAvLyBMaWtlIHRoZSBjYXJkXHJcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9saWtlcyA9IHVwZGF0ZWRDYXJkLmxpa2VzOyAvLyBVcGRhdGUgdGhlIGxpa2VzIGFycmF5XHJcbiAgICAgICAgICB0aGlzLl9zZXRMaWtlU3RhdGUoKTsgLy8gVXBkYXRlIFVJIGJhc2VkIG9uIHRoZSBuZXcgbGlrZSBzdGF0dXNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGBFcnJvciBsaWtpbmcgY2FyZDogJHtlcnJ9YCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl90b2dnbGVMaWtlKCk7IC8vIFRvZ2dsZSBsaWtlL3VubGlrZSBvbiBjbGlja1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgXCJjbGlja1wiLFxyXG4gICAgICAoKSA9PiBoYW5kbGVEZWxldGVDYXJkKHRoaXMuX2NhcmRFbGVtZW50LCB0aGlzLl9pZCkgLy8gT3BlbiBkZWxldGUgY29uZmlybWF0aW9uXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NyZWF0ZUNhcmRFbGVtZW50KCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAvLyBDb25zdHJ1Y3RvciBpbml0aWFsaXplcyB0aGUgY2xhc3Mgd2l0aCB2YWxpZGF0aW9uIHNldHRpbmdzIGFuZCB0aGUgZm9ybSBlbGVtZW50IHRvIGJlIHZhbGlkYXRlZFxyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5nczsgLy8gT2JqZWN0IGNvbnRhaW5pbmcgdmFsaWRhdGlvbiBzZXR0aW5ncyAoc2VsZWN0b3JzLCBjbGFzc2VzKVxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDsgLy8gVGhlIGZvcm0gZWxlbWVudCB0aGF0IHdpbGwgYmUgdmFsaWRhdGVkXHJcblxyXG4gICAgLy8gQ3JlYXRlIGFuIGFycmF5IG9mIGFsbCBpbnB1dCBlbGVtZW50cyBpbnNpZGUgdGhlIGZvcm1cclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcblxyXG4gICAgLy8gU2VsZWN0IHRoZSBzdWJtaXQgYnV0dG9uIGluc2lkZSB0aGUgZm9ybVxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBjaGVjayBpZiBhbnkgaW5wdXQgZmllbGQgaXMgaW52YWxpZFxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAvLyBVc2UgdGhlICdzb21lJyBhcnJheSBtZXRob2QgdG8gY2hlY2sgaWYgYW55IGlucHV0IGZpZWxkIGlzIGludmFsaWRcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIGVuYWJsZSBvciBkaXNhYmxlIHRoZSBzdWJtaXQgYnV0dG9uIGJhc2VkIG9uIGZvcm0gdmFsaWRpdHlcclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAvLyBJZiBhbnkgaW5wdXQgaXMgaW52YWxpZCwgZGlzYWJsZSB0aGUgc3VibWl0IGJ1dHRvbiwgb3RoZXJ3aXNlIGVuYWJsZSBpdFxyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpOyAvLyBEaXNhYmxlIHRoZSBidXR0b24gaWYgdGhlcmUgaXMgYW4gaW52YWxpZCBpbnB1dFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gRW5hYmxlIHRoZSBidXR0b24gYnkgcmVtb3ZpbmcgdGhlIGluYWN0aXZlIGNsYXNzIGFuZCBzZXR0aW5nIHRoZSBkaXNhYmxlZCBwcm9wZXJ0eSB0byBmYWxzZVxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBjaGVjayB0aGUgdmFsaWRpdHkgb2YgYSBzcGVjaWZpYyBpbnB1dCBlbGVtZW50IGFuZCBzaG93L2hpZGUgZXJyb3IgbWVzc2FnZXNcclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgLy8gU2VsZWN0IHRoZSBlcnJvciBtZXNzYWdlIGVsZW1lbnQgYXNzb2NpYXRlZCB3aXRoIHRoZSBpbnB1dCBmaWVsZFxyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIC8vIElmIHRoZSBpbnB1dCBpcyBpbnZhbGlkLCBzaG93IHRoZSBlcnJvciBtZXNzYWdlIGFuZCBhcHBseSB0aGUgZXJyb3IgY2xhc3NcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7IC8vIEFkZCBlcnJvciBjbGFzcyB0byB0aGUgaW5wdXRcclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlOyAvLyBEaXNwbGF5IHRoZSB2YWxpZGF0aW9uIGVycm9yIG1lc3NhZ2VcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIElmIHRoZSBpbnB1dCBpcyB2YWxpZCwgcmVtb3ZlIHRoZSBlcnJvciBjbGFzcyBhbmQgY2xlYXIgdGhlIGVycm9yIG1lc3NhZ2VcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTsgLy8gUmVtb3ZlIGVycm9yIGNsYXNzXHJcbiAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7IC8vIENsZWFyIHRoZSBlcnJvciBtZXNzYWdlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBzZXQgdXAgZXZlbnQgbGlzdGVuZXJzIGZvciBpbnB1dCBmaWVsZHNcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBJbml0aWFsbHkgY2hlY2sgdGhlIGJ1dHRvbiBzdGF0ZSB0byBtYWtlIHN1cmUgaXQgcmVmbGVjdHMgdGhlIGZvcm0ncyBjdXJyZW50IHN0YXRlXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIC8vIEFkZCBhbiAnaW5wdXQnIGV2ZW50IGxpc3RlbmVyIHRvIGVhY2ggaW5wdXQgZmllbGQgdG8gdmFsaWRhdGUgdGhlIGlucHV0IGluIHJlYWwtdGltZVxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTsgLy8gQ2hlY2sgdGhlIHZhbGlkaXR5IG9mIHRoZSBpbnB1dCBmaWVsZFxyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vIFVwZGF0ZSB0aGUgYnV0dG9uIHN0YXRlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGlucHV0IHZhbGlkaXR5XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRvIGVuYWJsZSBmb3JtIHZhbGlkYXRpb24gYnkgc2V0dGluZyBldmVudCBsaXN0ZW5lcnNcclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgaW5wdXQgZmllbGRzIGFuZCBmb3JtIHZhbGlkYXRpb25cclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gcmVzZXQgZm9ybSB2YWxpZGF0aW9uIChjbGVhciBlcnJvcnMgYW5kIHJlc2V0IGJ1dHRvbiBzdGF0ZSlcclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyBDbGVhciB2YWxpZGF0aW9uIGVycm9ycyBmb3IgYWxsIGlucHV0c1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgICApO1xyXG4gICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpOyAvLyBSZW1vdmUgZXJyb3IgY2xhc3NcclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjsgLy8gQ2xlYXIgdGhlIGVycm9yIG1lc3NhZ2VcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFJlc2V0IHRoZSBzdWJtaXQgYnV0dG9uJ3Mgc3RhdGVcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vIEVuc3VyZSB0aGUgYnV0dG9uIHJlZmxlY3RzIHRoZSBjdXJyZW50IGZvcm0gdmFsaWRpdHlcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZGlzYWJsZSB0aGUgc3VibWl0IGJ1dHRvblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICAvLyBBZGQgdGhlIGluYWN0aXZlIGNsYXNzIGFuZCBzZXQgdGhlIGRpc2FibGVkIHByb3BlcnR5IHRvIHRydWVcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7IC8vIEJpbmQgdGhlIGNvbnRleHQgb2YgX2hhbmRsZUVzY0Nsb3NlXHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgcG9wdXAgaWYgRVNDIGlzIHByZXNzZWRcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTsgLy8gQ2xvc2UgdGhlIHBvcHVwIGlmIGNsaWNrZWQgb24gb3ZlcmxheVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpOyAvLyBDYWxsIHRoZSBjb25zdHJ1Y3RvciBvZiB0aGUgcGFyZW50IGNsYXNzIChQb3B1cClcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTsgLy8gSW5pdGlhbGl6ZSBhbiBlbXB0eSBvYmplY3QgdG8gaG9sZCBmb3JtIGRhdGFcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7IC8vIFJldHVybiB0aGUgb2JqZWN0IGNvbnRhaW5pbmcgYWxsIGlucHV0IHZhbHVlc1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpOyAvLyBDYWxsIHRoZSBwYXJlbnQgY2xhc3MgbWV0aG9kIHRvIGhhbmRsZSBwb3B1cCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTsgLy8gUHJldmVudCB0aGUgZGVmYXVsdCBmb3JtIHN1Ym1pc3Npb24gYmVoYXZpb3JcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTsgLy8gQ2FsbCB0aGUgZm9ybSBzdWJtaXQgaGFuZGxlciBmdW5jdGlvblxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpOyAvLyBSZXNldCB0aGUgZm9ybSBhZnRlciBzdWJtaXNzaW9uXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiLy8gSW1wb3J0cyBtb2R1bGVzIGFuZCBjbGFzc2VzXHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MsIHNlbGVjdG9ycyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuLy8gSW5pdGlhbGl6ZSB0aGUgQVBJIGluc3RhbmNlXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjI4NDRkYzc5LTYzNDAtNDc2ZS04YmY2LWVhNTUzMTE3MTZkMVwiLCAvLyBSZXBsYWNlIHdpdGggeW91ciBhY3R1YWwgdG9rZW5cclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8gRGVzdHJ1Y3R1cmVkIHNlbGVjdG9ycyBmcm9tIHRoZSBjb25zdGFudHMgZmlsZVxyXG5jb25zdCB7XHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIGFkZENhcmRGb3JtLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXHJcbn0gPSBzZWxlY3RvcnM7XHJcblxyXG4vLyBJbml0aWFsaXplIFVzZXJJbmZvIHRvIG1hbmFnZSBhbmQgdXBkYXRlIHByb2ZpbGUgZGF0YSAobmFtZSBhbmQgZGVzY3JpcHRpb24pXHJcbmNvbnN0IHVzZXJJbmZvSW5zdGFuY2UgPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG59KTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGhhbmRsZSBvcGVuaW5nIHRoZSBkZWxldGUgY29uZmlybWF0aW9uIHBvcHVwXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmRJZCkge1xyXG4gIGNvbnN0IGRlbGV0ZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1wb3B1cFwiKTtcclxuICBjb25zdCBjb25maXJtRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb25maXJtLWRlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gIC8vIE9wZW4gdGhlIGRlbGV0ZSBjb25maXJtYXRpb24gcG9wdXBcclxuICBkZWxldGVQb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG5cclxuICAvLyBXaGVuIHRoZSB1c2VyIGNvbmZpcm1zIHRoZSBkZWxldGlvblxyXG4gIGNvbmZpcm1EZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpIC8vIEFQSSBjYWxsIHRvIGRlbGV0ZSB0aGUgY2FyZFxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBjYXJkIGZyb20gdGhlIFVJXHJcbiAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgLy8gQ2xvc2UgdGhlIHBvcHVwIGFmdGVyIGRlbGV0aW9uXHJcbiAgICAgICAgZGVsZXRlUG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlbGV0aW5nIGNhcmQ6ICR7ZXJyfWApKTtcclxuICB9KTtcclxuXHJcbiAgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVyIHRvIGNsb3NlIHRoZSBwb3B1cFxyXG4gIGRlbGV0ZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBkZWxldGVQb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBjcmVhdGUgYSBuZXcgY2FyZCB1c2luZyB0aGUgQ2FyZCBjbGFzc1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGNhcmREYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIsIGhhbmRsZUltYWdlUG9wdXApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTsgLy8gUmV0dXJuIHRoZSBjYXJkIGVsZW1lbnQgZm9yIHJlbmRlcmluZ1xyXG59XHJcblxyXG4vLyBJbml0aWFsaXplIHRoZSBTZWN0aW9uIGNsYXNzIHRvIHJlbmRlciBhbmQgbWFuYWdlIHRoZSBjYXJkIGxpc3RcclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmNhcmRzX19saXN0XCJcclxuKTtcclxuXHJcbi8vIEFQSSBDYWxscyAtIEZldGNoIGFuZCByZW5kZXIgdXNlciBpbmZvIGFuZCBjYXJkc1xyXG5hcGlcclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKCh1c2VySW5mbykgPT4ge1xyXG4gICAgdXNlckluZm9JbnN0YW5jZS5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHVzZXJJbmZvLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB1c2VySW5mby5hYm91dCxcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycikpO1xyXG5cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBjYXJkczpcIiwgZXJyKSk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBvcGVuIHRoZSBwcm9maWxlIGVkaXQgcG9wdXAgd2l0aCBjdXJyZW50IHVzZXIgZGF0YVxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdCgpIHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvSW5zdGFuY2UuZ2V0VXNlckluZm8oKTsgLy8gR2V0IGN1cnJlbnQgcHJvZmlsZSBkYXRhIChuYW1lLCBkZXNjcmlwdGlvbilcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7IC8vIFByZS1maWxsIHRoZSBmb3JtIHdpdGggdGhlIGN1cnJlbnQgbmFtZVxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuZGVzY3JpcHRpb247IC8vIFByZS1maWxsIHRoZSBmb3JtIHdpdGggdGhlIGN1cnJlbnQgZGVzY3JpcHRpb25cclxuXHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7IC8vIFJlc2V0IHZhbGlkYXRpb24gc3RhdGUgZm9yIHRoZSBmb3JtXHJcbiAgcHJvZmlsZUVkaXRQb3B1cEluc3RhbmNlLm9wZW4oKTsgLy8gT3BlbiB0aGUgcG9wdXBcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gb3BlbiB0aGUgaW1hZ2UgcG9wdXAgd2l0aCB0aGUgcHJvdmlkZWQgaW1hZ2UgbGluayBhbmQgbmFtZVxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZVBvcHVwKGxpbmssIG5hbWUpIHtcclxuICBwaWN0dXJlUG9wdXBJbnN0YW5jZS5vcGVuKHsgbmFtZSwgbGluayB9KTsgLy8gUGFzcyB0aGUgaW1hZ2UgZGF0YSB0byB0aGUgcG9wdXAgaW5zdGFuY2VcclxufVxyXG5cclxuLy8gSW5pdGlhbGl6ZSB0aGUgcHJvZmlsZSBlZGl0IHBvcHVwIHdpdGggZm9ybSBoYW5kbGluZ1xyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtcG9wdXBcIixcclxuICAoZm9ybURhdGEpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAudXBkYXRlVXNlckluZm8oZm9ybURhdGEpIC8vIEFQSSBjYWxsIHRvIHVwZGF0ZSB1c2VyIGluZm9cclxuICAgICAgLnRoZW4oKHVwZGF0ZWRVc2VySW5mbykgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvSW5zdGFuY2Uuc2V0VXNlckluZm8oe1xyXG4gICAgICAgICAgbmFtZTogdXBkYXRlZFVzZXJJbmZvLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlZFVzZXJJbmZvLmFib3V0LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHByb2ZpbGVFZGl0UG9wdXBJbnN0YW5jZS5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgcG9wdXAgYWZ0ZXIgc3VibWlzc2lvblxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycikpO1xyXG4gIH1cclxuKTtcclxucHJvZmlsZUVkaXRQb3B1cEluc3RhbmNlLnNldEV2ZW50TGlzdGVuZXJzKCk7IC8vIFNldCB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBwb3B1cFxyXG5cclxuLy8gSW5pdGlhbGl6ZSB0aGUgYWRkIGNhcmQgcG9wdXAgd2l0aCBmb3JtIGhhbmRsaW5nXHJcbmNvbnN0IGFkZENhcmRQb3B1cEluc3RhbmNlID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjYWRkLWNhcmQtcG9wdXBcIixcclxuICAoZm9ybURhdGEpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuYWRkQ2FyZChmb3JtRGF0YSkgLy8gQVBJIGNhbGwgdG8gYWRkIGEgbmV3IGNhcmRcclxuICAgICAgLnRoZW4oKG5ld0NhcmQpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQobmV3Q2FyZCk7IC8vIENyZWF0ZSB0aGUgbmV3IGNhcmRcclxuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTsgLy8gQWRkIGl0IHRvIHRoZSBzZWN0aW9uXHJcbiAgICAgICAgYWRkQ2FyZFBvcHVwSW5zdGFuY2UuY2xvc2UoKTsgLy8gQ2xvc2UgdGhlIHBvcHVwIGFmdGVyIHN1Ym1pc3Npb25cclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhZGRpbmcgY2FyZDpcIiwgZXJyKSk7XHJcbiAgfVxyXG4pO1xyXG5hZGRDYXJkUG9wdXBJbnN0YW5jZS5zZXRFdmVudExpc3RlbmVycygpOyAvLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgcG9wdXBcclxuXHJcbi8vIEluaXRpYWxpemUgdGhlIGltYWdlIHBvcHVwIGZvciBkaXNwbGF5aW5nIGxhcmdlciBpbWFnZXNcclxuY29uc3QgcGljdHVyZVBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcGljdHVyZS1wb3B1cFwiKTtcclxucGljdHVyZVBvcHVwSW5zdGFuY2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHBvcHVwXHJcblxyXG4vLyBJbml0aWFsaXplIGZvcm0gdmFsaWRhdG9ycyBmb3IgdGhlIHByb2ZpbGUgYW5kIGNhcmQgZm9ybXNcclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBmb3JtVmFsaWRhdGlvblNldHRpbmdzLFxyXG4gIHByb2ZpbGVFZGl0Rm9ybVxyXG4pO1xyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgYWRkQ2FyZEZvcm1cclxuKTtcclxuXHJcbi8vIEVuYWJsZSBmb3JtIHZhbGlkYXRpb24gZm9yIGJvdGggZm9ybXNcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgcHJvZmlsZSBlZGl0IGFuZCBhZGQgY2FyZCBidXR0b25zXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVQcm9maWxlRWRpdCk7XHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXBJbnN0YW5jZS5vcGVuKCk7IC8vIE9wZW4gdGhlIGFkZCBjYXJkIHBvcHVwIHdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkXHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgLy8gQ29uc3RydWN0b3IgaW5pdGlhbGl6ZXMgdGhlIGNsYXNzIHdpdGggdGhlIHNlbGVjdG9ycyBmb3IgdGhlIG5hbWUgYW5kIGRlc2NyaXB0aW9uIGVsZW1lbnRzXHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IgfSkge1xyXG4gICAgLy8gR2V0IHRoZSBET00gZWxlbWVudCBmb3IgdGhlIHVzZXIncyBuYW1lIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBzZWxlY3RvclxyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcblxyXG4gICAgLy8gR2V0IHRoZSBET00gZWxlbWVudCBmb3IgdGhlIHVzZXIncyBkZXNjcmlwdGlvbiBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgc2VsZWN0b3JcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyBNZXRob2QgdG8gZ2V0IHRoZSBjdXJyZW50IHVzZXIgaW5mb3JtYXRpb24gKG5hbWUgYW5kIGRlc2NyaXB0aW9uKSBmcm9tIHRoZSBET01cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIC8vIFJldHVybiBhbiBvYmplY3QgY29udGFpbmluZyB0aGUgY3VycmVudCBuYW1lIGFuZCBkZXNjcmlwdGlvbiB0ZXh0IGZyb20gdGhlIERPTSBlbGVtZW50c1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsIC8vIEdldCB0aGUgbmFtZSBmcm9tIHRoZSBET00gZWxlbWVudFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LCAvLyBHZXQgdGhlIGRlc2NyaXB0aW9uIGZyb20gdGhlIERPTSBlbGVtZW50XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gTWV0aG9kIHRvIHVwZGF0ZSB0aGUgdXNlcidzIGluZm9ybWF0aW9uIGluIHRoZSBET01cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIC8vIFVwZGF0ZSB0aGUgRE9NIGVsZW1lbnQgd2l0aCB0aGUgbmV3IG5hbWVcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIERPTSBlbGVtZW50IHdpdGggdGhlIG5ldyBkZXNjcmlwdGlvblxyXG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pOyAvLyBSZW5kZXIgZWFjaCBpdGVtIGFuZCBhZGQgaXQgdG8gdGhlIGNvbnRhaW5lciB2aWEgdGhlIHJlbmRlcmVyXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0ocmVuZGVyZWRJdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChyZW5kZXJlZEl0ZW0pOyAvLyBBZGQgdGhlIHJlbmRlcmVkIGl0ZW0gdG8gdGhlIHRvcCBvZiB0aGUgY29udGFpbmVyXHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXB0aW9uRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7IC8vIFNldCB0aGUgaW1hZ2UgVVJMXHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTsgLy8gU2V0IHRoZSBpbWFnZSBhbHQgdGV4dFxyXG4gICAgdGhpcy5fY2FwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lOyAvLyBTZXQgdGhlIGNhcHRpb24gdGV4dFxyXG4gICAgc3VwZXIub3BlbigpOyAvLyBPcGVuIHRoZSBwb3B1cFxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZm9ybVZhbGlkYXRpb25TZXR0aW5ncyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJzZWxlY3RvcnMiLCJwcm9maWxlRWRpdEZvcm0iLCJkb2N1bWVudCIsImZvcm1zIiwiYWRkQ2FyZEZvcm0iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRDYXJkQnV0dG9uIiwicHJvZmlsZUVkaXRQb3B1cCIsImFkZENhcmRQb3B1cCIsInBpY3R1cmVQb3B1cCIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTGlzdEVsIiwiYWRkQ2FyZFRpdGxlSW5wdXQiLCJhZGRDYXJkVXJsSW5wdXQiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsIm5hbWUiLCJsaW5rIiwiX2lkIiwibGlrZXMiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9saWtlcyIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9jcmVhdGVDYXJkRWxlbWVudCIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkRWxlbWVudCIsIl9saWtlQnV0dG9uIiwiX3RyYXNoQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiX2NhcmRUaXRsZUVsIiwiX2xpa2VDb3VudEVsIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfc2V0TGlrZVN0YXRlIiwic29tZSIsInVzZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaXNMaWtlZCIsInJlbW92ZSIsImxlbmd0aCIsIl90b2dnbGVMaWtlIiwiYXBpIiwiZGlzbGlrZUNhcmQiLCJ0aGVuIiwidXBkYXRlZENhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImxpa2VDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZURlbGV0ZUNhcmQiLCJnZXRWaWV3IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mb0luc3RhbmNlIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJfcmVmMiIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsImhhbmRsZUltYWdlUG9wdXAiLCJjYXJkU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicmVuZGVyZWRJdGVtIiwicHJlcGVuZCIsInBpY3R1cmVQb3B1cEluc3RhbmNlIiwidXNlckluZm8iLCJhYm91dCIsImdldEluaXRpYWxDYXJkcyIsImNhcmRzIiwicHJvZmlsZUVkaXRQb3B1cEluc3RhbmNlIiwiZm9ybURhdGEiLCJ1cGRhdGVVc2VySW5mbyIsInVwZGF0ZWRVc2VySW5mbyIsImFkZENhcmRQb3B1cEluc3RhbmNlIiwiYWRkQ2FyZCIsIm5ld0NhcmQiLCJfaW1hZ2VFbGVtZW50IiwiX2NhcHRpb25FbGVtZW50IiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJjYXJkRm9ybVZhbGlkYXRvciIsInVzZXJEYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==
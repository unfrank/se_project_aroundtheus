!function(){var t={240:function(){}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,i),s.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";var t=i(240),e=i.n(t);const n={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error"},r={profileEditForm:document.forms["profile-form"],addCardForm:document.forms["card-form"],profileEditButton:document.querySelector("#profile-edit-button"),addCardButton:document.querySelector("#profile-add-button"),profileEditPopup:document.querySelector("#profile-edit-popup"),addCardPopup:document.querySelector("#add-card-popup"),picturePopup:document.querySelector("#picture-popup"),profileTitle:document.querySelector(".profile__title"),profileDescription:document.querySelector(".profile__description"),profileTitleInput:document.querySelector("#profile-title-input"),profileDescriptionInput:document.querySelector("#profile-description-input"),cardListEl:document.querySelector(".cards__list"),addCardTitleInput:document.querySelector("#add-card-title"),addCardUrlInput:document.querySelector("#add-card-url")};class s{constructor(t,e,i){let{name:n,link:r,_id:s,likes:o}=t;this._name=n,this._link=r,this._id=s,this._likes=o,this._cardSelector=e,this._handleImageClick=i}_createCardElement(){const t=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);return this._cardElement=t,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._trashButton=this._cardElement.querySelector(".card__trash-button"),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._likeCountEl=this._cardElement.querySelector(".card__like-count"),this._cardTitleEl.textContent=this._name,this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._setLikeState(),this._cardElement}_setLikeState(){this._likes.some((t=>"your-user-id"===t._id))?(this._likeButton.classList.add("card__like-button_active"),this._isLiked=!0):(this._likeButton.classList.remove("card__like-button_active"),this._isLiked=!1),this._likeCountEl.textContent=this._likes.length}_toggleLike(){this._isLiked?api.dislikeCard(this._id).then((t=>{this._likes=t.likes,this._setLikeState()})).catch((t=>console.error(`Error unliking card: ${t}`))):api.likeCard(this._id).then((t=>{this._likes=t.likes,this._setLikeState()})).catch((t=>console.error(`Error liking card: ${t}`)))}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._toggleLike()})),this._trashButton.addEventListener("click",(()=>handleDeleteCard(this._cardElement,this._id))),this._cardImageEl.addEventListener("click",(()=>this._handleImageClick(this._link,this._name)))}getView(){return this._createCardElement(),this._setEventListeners(),this._cardElement}}class o{constructor(t,e){this._settings=t,this._formElement=e,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1)}_checkInputValidity(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.validity.valid?(t.classList.remove(this._settings.inputErrorClass),e.textContent=""):(t.classList.add(this._settings.inputErrorClass),e.textContent=t.validationMessage)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}resetValidation(){this._inputList.forEach((t=>{const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._settings.inputErrorClass),e.textContent=""})),this._toggleButtonState()}disableButton(){this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0}}class l{constructor(t){this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close").addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",(t=>{t.target===this._popupElement&&this.close()}))}}class a extends l{constructor(t,e){super(t),this._handleFormSubmit=e,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputList=Array.from(this._formElement.querySelectorAll(".popup__input"))}_getInputValues(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._formElement.reset()}))}}const c=new(e())({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2844dc79-6340-476e-8bf6-ea55311716d1","Content-Type":"application/json"}}),{profileEditForm:d,addCardForm:u,profileEditButton:p,addCardButton:_,profileTitleInput:h,profileDescriptionInput:m}=r,E=new class{constructor(t){let{nameSelector:e,descriptionSelector:i}=t;this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(t){let{name:e,description:i}=t;this._nameElement.textContent=e,this._descriptionElement.textContent=i}}({nameSelector:".profile__title",descriptionSelector:".profile__description"});function f(t){return new s(t,"#card-template",S).getView()}const v=new class{constructor(t,e){let{items:i,renderer:n}=t;this._items=i,this._renderer=n,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}({renderer:t=>{const e=f(t);v.addItem(e)}},".cards__list");function S(t,e){C.open({name:e,link:t})}c.getUserInfo().then((t=>{E.setUserInfo({name:t.name,description:t.about})})).catch((t=>console.error("Error fetching user info:",t))),c.getInitialCards().then((t=>{t.forEach((t=>{const e=f(t);v.addItem(e)}))})).catch((t=>console.error("Error fetching cards:",t)));const k=new a("#profile-edit-popup",(t=>{c.updateUserInfo(t).then((t=>{E.setUserInfo({name:t.name,description:t.about}),k.close()})).catch((t=>console.error("Error updating profile:",t)))}));k.setEventListeners();const g=new a("#add-card-popup",(t=>{c.addCard(t).then((t=>{const e=f(t);v.addItem(e),g.close()})).catch((t=>console.error("Error adding card:",t)))}));g.setEventListeners();const y=document.querySelector("#edit-avatar-button"),L=new a("#avatar-edit-popup",(t=>{c.updateAvatar(t.avatar).then((t=>{document.querySelector(".profile__image").src=t.avatar,L.close()})).catch((t=>console.error("Error updating avatar:",t)))}));y.addEventListener("click",(()=>{L.open()})),L.setEventListeners();const C=new class extends l{constructor(t){super(t),this._imageElement=this._popupElement.querySelector(".popup__image"),this._captionElement=this._popupElement.querySelector(".popup__caption")}open(t){let{name:e,link:i}=t;this._imageElement.src=i,this._imageElement.alt=e,this._captionElement.textContent=e,super.open()}}("#picture-popup");C.setEventListeners();const b=new o(n,d),q=new o(n,u);b.enableValidation(),q.enableValidation(),p.addEventListener("click",(function(){const t=E.getUserInfo();h.value=t.name,m.value=t.description,b.resetValidation(),k.open()})),_.addEventListener("click",(()=>{g.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzNCLElBZ0ZBMUYsRUFBYzBELGlCQUFpQixTQUFTLEtBQ3RDcUYsRUFBcUJyRCxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZTsgfTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsIi8vIEZvcm0gVmFsaWRhdGlvbiBTZXR0aW5nc1xyXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG59O1xyXG5cclxuLy8gSW5pdGlhbCBDYXJkc1xyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vIEVsZW1lbnQgU2VsZWN0b3JzXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgcHJvZmlsZUVkaXRGb3JtOiBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXSxcclxuICBhZGRDYXJkRm9ybTogZG9jdW1lbnQuZm9ybXNbXCJjYXJkLWZvcm1cIl0sXHJcbiAgcHJvZmlsZUVkaXRCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKSxcclxuICBhZGRDYXJkQnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKSxcclxuICBwcm9maWxlRWRpdFBvcHVwOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1wb3B1cFwiKSxcclxuICBhZGRDYXJkUG9wdXA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtcG9wdXBcIiksXHJcbiAgcGljdHVyZVBvcHVwOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BpY3R1cmUtcG9wdXBcIiksXHJcbiAgcHJvZmlsZVRpdGxlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKSxcclxuICBwcm9maWxlVGl0bGVJbnB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIiksXHJcbiAgY2FyZExpc3RFbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKSxcclxuICBhZGRDYXJkVGl0bGVJbnB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC10aXRsZVwiKSxcclxuICBhZGRDYXJkVXJsSW5wdXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtdXJsXCIpLFxyXG59O1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGxpbmssIF9pZCwgbGlrZXMgfSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5faWQgPSBfaWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzOyAvLyBMaXN0IG9mIHVzZXJzIHdobyBsaWtlZCB0aGUgY2FyZFxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgfVxyXG5cclxuICBfY3JlYXRlQ2FyZEVsZW1lbnQoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBjYXJkRWxlbWVudDtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2xpa2VDb3VudEVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50XCIpOyAvLyBBc3N1bWluZyB0aGVyZeKAmXMgYSBzcGFuIHRvIHNob3cgbGlrZSBjb3VudFxyXG5cclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIC8vIFNldCB0aGUgaW5pdGlhbCBsaWtlIHN0YXRlIGFuZCBjb3VudFxyXG4gICAgdGhpcy5fc2V0TGlrZVN0YXRlKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgaWYgdGhlIGNhcmQgaXMgbGlrZWQgYW5kIHVwZGF0ZSB0aGUgaGVhcnQgaWNvblxyXG4gIF9zZXRMaWtlU3RhdGUoKSB7XHJcbiAgICBjb25zdCB1c2VyTGlrZWQgPSB0aGlzLl9saWtlcy5zb21lKCh1c2VyKSA9PiB1c2VyLl9pZCA9PT0gXCJ5b3VyLXVzZXItaWRcIik7IC8vIFJlcGxhY2UgXCJ5b3VyLXVzZXItaWRcIiB3aXRoIHRoZSBhY3R1YWwgdXNlciBJRFxyXG4gICAgaWYgKHVzZXJMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7IC8vIENoYW5nZSBoZWFydCBjb2xvclxyXG4gICAgICB0aGlzLl9pc0xpa2VkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgICAgdGhpcy5faXNMaWtlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fbGlrZUNvdW50RWwudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlTGlrZSgpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIGFwaVxyXG4gICAgICAgIC5kaXNsaWtlQ2FyZCh0aGlzLl9pZCkgLy8gVW5saWtlIHRoZSBjYXJkXHJcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9saWtlcyA9IHVwZGF0ZWRDYXJkLmxpa2VzOyAvLyBVcGRhdGUgdGhlIGxpa2VzIGFycmF5XHJcbiAgICAgICAgICB0aGlzLl9zZXRMaWtlU3RhdGUoKTsgLy8gVXBkYXRlIFVJIGJhc2VkIG9uIHRoZSBuZXcgbGlrZSBzdGF0dXNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGBFcnJvciB1bmxpa2luZyBjYXJkOiAke2Vycn1gKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcGlcclxuICAgICAgICAubGlrZUNhcmQodGhpcy5faWQpIC8vIExpa2UgdGhlIGNhcmRcclxuICAgICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2xpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7IC8vIFVwZGF0ZSB0aGUgbGlrZXMgYXJyYXlcclxuICAgICAgICAgIHRoaXMuX3NldExpa2VTdGF0ZSgpOyAvLyBVcGRhdGUgVUkgYmFzZWQgb24gdGhlIG5ldyBsaWtlIHN0YXR1c1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yIGxpa2luZyBjYXJkOiAke2Vycn1gKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX3RvZ2dsZUxpa2UoKTsgLy8gVG9nZ2xlIGxpa2UvdW5saWtlIG9uIGNsaWNrXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBcImNsaWNrXCIsXHJcbiAgICAgICgpID0+IGhhbmRsZURlbGV0ZUNhcmQodGhpcy5fY2FyZEVsZW1lbnQsIHRoaXMuX2lkKSAvLyBPcGVuIGRlbGV0ZSBjb25maXJtYXRpb25cclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbGluaywgdGhpcy5fbmFtZSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY3JlYXRlQ2FyZEVsZW1lbnQoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIC8vIENvbnN0cnVjdG9yIGluaXRpYWxpemVzIHRoZSBjbGFzcyB3aXRoIHZhbGlkYXRpb24gc2V0dGluZ3MgYW5kIHRoZSBmb3JtIGVsZW1lbnQgdG8gYmUgdmFsaWRhdGVkXHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzOyAvLyBPYmplY3QgY29udGFpbmluZyB2YWxpZGF0aW9uIHNldHRpbmdzIChzZWxlY3RvcnMsIGNsYXNzZXMpXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50OyAvLyBUaGUgZm9ybSBlbGVtZW50IHRoYXQgd2lsbCBiZSB2YWxpZGF0ZWRcclxuXHJcbiAgICAvLyBDcmVhdGUgYW4gYXJyYXkgb2YgYWxsIGlucHV0IGVsZW1lbnRzIGluc2lkZSB0aGUgZm9ybVxyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBTZWxlY3QgdGhlIHN1Ym1pdCBidXR0b24gaW5zaWRlIHRoZSBmb3JtXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIGNoZWNrIGlmIGFueSBpbnB1dCBmaWVsZCBpcyBpbnZhbGlkXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIC8vIFVzZSB0aGUgJ3NvbWUnIGFycmF5IG1ldGhvZCB0byBjaGVjayBpZiBhbnkgaW5wdXQgZmllbGQgaXMgaW52YWxpZFxyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgLy8gUHJpdmF0ZSBtZXRob2QgdG8gZW5hYmxlIG9yIGRpc2FibGUgdGhlIHN1Ym1pdCBidXR0b24gYmFzZWQgb24gZm9ybSB2YWxpZGl0eVxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIC8vIElmIGFueSBpbnB1dCBpcyBpbnZhbGlkLCBkaXNhYmxlIHRoZSBzdWJtaXQgYnV0dG9uLCBvdGhlcndpc2UgZW5hYmxlIGl0XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7IC8vIERpc2FibGUgdGhlIGJ1dHRvbiBpZiB0aGVyZSBpcyBhbiBpbnZhbGlkIGlucHV0XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBFbmFibGUgdGhlIGJ1dHRvbiBieSByZW1vdmluZyB0aGUgaW5hY3RpdmUgY2xhc3MgYW5kIHNldHRpbmcgdGhlIGRpc2FibGVkIHByb3BlcnR5IHRvIGZhbHNlXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIGNoZWNrIHRoZSB2YWxpZGl0eSBvZiBhIHNwZWNpZmljIGlucHV0IGVsZW1lbnQgYW5kIHNob3cvaGlkZSBlcnJvciBtZXNzYWdlc1xyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAvLyBTZWxlY3QgdGhlIGVycm9yIG1lc3NhZ2UgZWxlbWVudCBhc3NvY2lhdGVkIHdpdGggdGhlIGlucHV0IGZpZWxkXHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgLy8gSWYgdGhlIGlucHV0IGlzIGludmFsaWQsIHNob3cgdGhlIGVycm9yIG1lc3NhZ2UgYW5kIGFwcGx5IHRoZSBlcnJvciBjbGFzc1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTsgLy8gQWRkIGVycm9yIGNsYXNzIHRvIHRoZSBpbnB1dFxyXG4gICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7IC8vIERpc3BsYXkgdGhlIHZhbGlkYXRpb24gZXJyb3IgbWVzc2FnZVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gSWYgdGhlIGlucHV0IGlzIHZhbGlkLCByZW1vdmUgdGhlIGVycm9yIGNsYXNzIGFuZCBjbGVhciB0aGUgZXJyb3IgbWVzc2FnZVxyXG4gICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpOyAvLyBSZW1vdmUgZXJyb3IgY2xhc3NcclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjsgLy8gQ2xlYXIgdGhlIGVycm9yIG1lc3NhZ2VcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIHNldCB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIGlucHV0IGZpZWxkc1xyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vIEluaXRpYWxseSBjaGVjayB0aGUgYnV0dG9uIHN0YXRlIHRvIG1ha2Ugc3VyZSBpdCByZWZsZWN0cyB0aGUgZm9ybSdzIGN1cnJlbnQgc3RhdGVcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgLy8gQWRkIGFuICdpbnB1dCcgZXZlbnQgbGlzdGVuZXIgdG8gZWFjaCBpbnB1dCBmaWVsZCB0byB2YWxpZGF0ZSB0aGUgaW5wdXQgaW4gcmVhbC10aW1lXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpOyAvLyBDaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhlIGlucHV0IGZpZWxkXHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgLy8gVXBkYXRlIHRoZSBidXR0b24gc3RhdGUgYmFzZWQgb24gdGhlIGN1cnJlbnQgaW5wdXQgdmFsaWRpdHlcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZW5hYmxlIGZvcm0gdmFsaWRhdGlvbiBieSBzZXR0aW5nIGV2ZW50IGxpc3RlbmVyc1xyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpOyAvLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXJzIGZvciBpbnB1dCBmaWVsZHMgYW5kIGZvcm0gdmFsaWRhdGlvblxyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljIG1ldGhvZCB0byByZXNldCBmb3JtIHZhbGlkYXRpb24gKGNsZWFyIGVycm9ycyBhbmQgcmVzZXQgYnV0dG9uIHN0YXRlKVxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIC8vIENsZWFyIHZhbGlkYXRpb24gZXJyb3JzIGZvciBhbGwgaW5wdXRzXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICAgICk7XHJcbiAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7IC8vIFJlbW92ZSBlcnJvciBjbGFzc1xyXG4gICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiOyAvLyBDbGVhciB0aGUgZXJyb3IgbWVzc2FnZVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUmVzZXQgdGhlIHN1Ym1pdCBidXR0b24ncyBzdGF0ZVxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgLy8gRW5zdXJlIHRoZSBidXR0b24gcmVmbGVjdHMgdGhlIGN1cnJlbnQgZm9ybSB2YWxpZGl0eVxyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljIG1ldGhvZCB0byBkaXNhYmxlIHRoZSBzdWJtaXQgYnV0dG9uXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIC8vIEFkZCB0aGUgaW5hY3RpdmUgY2xhc3MgYW5kIHNldCB0aGUgZGlzYWJsZWQgcHJvcGVydHkgdG8gdHJ1ZVxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTsgLy8gQmluZCB0aGUgY29udGV4dCBvZiBfaGFuZGxlRXNjQ2xvc2VcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7IC8vIENsb3NlIHRoZSBwb3B1cCBpZiBFU0MgaXMgcHJlc3NlZFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgcG9wdXAgaWYgY2xpY2tlZCBvbiBvdmVybGF5XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7IC8vIENhbGwgdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBwYXJlbnQgY2xhc3MgKFBvcHVwKVxyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIilcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9OyAvLyBJbml0aWFsaXplIGFuIGVtcHR5IG9iamVjdCB0byBob2xkIGZvcm0gZGF0YVxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlczsgLy8gUmV0dXJuIHRoZSBvYmplY3QgY29udGFpbmluZyBhbGwgaW5wdXQgdmFsdWVzXHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7IC8vIENhbGwgdGhlIHBhcmVudCBjbGFzcyBtZXRob2QgdG8gaGFuZGxlIHBvcHVwIGxpc3RlbmVyc1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBQcmV2ZW50IHRoZSBkZWZhdWx0IGZvcm0gc3VibWlzc2lvbiBiZWhhdmlvclxyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpOyAvLyBDYWxsIHRoZSBmb3JtIHN1Ym1pdCBoYW5kbGVyIGZ1bmN0aW9uXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7IC8vIFJlc2V0IHRoZSBmb3JtIGFmdGVyIHN1Ym1pc3Npb25cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCIvLyBJbXBvcnRzIG1vZHVsZXMgYW5kIGNsYXNzZXNcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25TZXR0aW5ncywgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcblxyXG4vLyBJbml0aWFsaXplIHRoZSBBUEkgaW5zdGFuY2VcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiMjg0NGRjNzktNjM0MC00NzZlLThiZjYtZWE1NTMxMTcxNmQxXCIsIC8vIFJlcGxhY2Ugd2l0aCB5b3VyIGFjdHVhbCB0b2tlblxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyBEZXN0cnVjdHVyZWQgc2VsZWN0b3JzIGZyb20gdGhlIGNvbnN0YW50cyBmaWxlXHJcbmNvbnN0IHtcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgYWRkQ2FyZEZvcm0sXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgYWRkQ2FyZEJ1dHRvbixcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxufSA9IHNlbGVjdG9ycztcclxuXHJcbi8vIEluaXRpYWxpemUgVXNlckluZm8gdG8gbWFuYWdlIGFuZCB1cGRhdGUgcHJvZmlsZSBkYXRhIChuYW1lIGFuZCBkZXNjcmlwdGlvbilcclxuY29uc3QgdXNlckluZm9JbnN0YW5jZSA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGRlc2NyaXB0aW9uU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbn0pO1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gaGFuZGxlIG9wZW5pbmcgdGhlIGRlbGV0ZSBjb25maXJtYXRpb24gcG9wdXBcclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XHJcbiAgY29uc3QgZGVsZXRlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLXBvcHVwXCIpO1xyXG4gIGNvbnN0IGNvbmZpcm1EZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbmZpcm0tZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgLy8gT3BlbiB0aGUgZGVsZXRlIGNvbmZpcm1hdGlvbiBwb3B1cFxyXG4gIGRlbGV0ZVBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcblxyXG4gIC8vIFdoZW4gdGhlIHVzZXIgY29uZmlybXMgdGhlIGRlbGV0aW9uXHJcbiAgY29uZmlybURlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmRJZCkgLy8gQVBJIGNhbGwgdG8gZGVsZXRlIHRoZSBjYXJkXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAvLyBSZW1vdmUgdGhlIGNhcmQgZnJvbSB0aGUgVUlcclxuICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICAvLyBDbG9zZSB0aGUgcG9wdXAgYWZ0ZXIgZGVsZXRpb25cclxuICAgICAgICBkZWxldGVQb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgRXJyb3IgZGVsZXRpbmcgY2FyZDogJHtlcnJ9YCkpO1xyXG4gIH0pO1xyXG5cclxuICAvLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXIgdG8gY2xvc2UgdGhlIHBvcHVwXHJcbiAgZGVsZXRlUG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGRlbGV0ZVBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNyZWF0ZSBhIG5ldyBjYXJkIHVzaW5nIHRoZSBDYXJkIGNsYXNzXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VQb3B1cCk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpOyAvLyBSZXR1cm4gdGhlIGNhcmQgZWxlbWVudCBmb3IgcmVuZGVyaW5nXHJcbn1cclxuXHJcbi8vIEluaXRpYWxpemUgdGhlIFNlY3Rpb24gY2xhc3MgdG8gcmVuZGVyIGFuZCBtYW5hZ2UgdGhlIGNhcmQgbGlzdFxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuLy8gQVBJIENhbGxzIC0gRmV0Y2ggYW5kIHJlbmRlciB1c2VyIGluZm8gYW5kIGNhcmRzXHJcbmFwaVxyXG4gIC5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4oKHVzZXJJbmZvKSA9PiB7XHJcbiAgICB1c2VySW5mb0luc3RhbmNlLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogdXNlckluZm8ubmFtZSxcclxuICAgICAgZGVzY3JpcHRpb246IHVzZXJJbmZvLmFib3V0LFxyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHVzZXIgaW5mbzpcIiwgZXJyKSk7XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigoY2FyZHMpID0+IHtcclxuICAgIGNhcmRzLmZvckVhY2goKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGNhcmRzOlwiLCBlcnIpKTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIG9wZW4gdGhlIHByb2ZpbGUgZWRpdCBwb3B1cCB3aXRoIGN1cnJlbnQgdXNlciBkYXRhXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0KCkge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm9JbnN0YW5jZS5nZXRVc2VySW5mbygpOyAvLyBHZXQgY3VycmVudCBwcm9maWxlIGRhdGEgKG5hbWUsIGRlc2NyaXB0aW9uKVxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTsgLy8gUHJlLWZpbGwgdGhlIGZvcm0gd2l0aCB0aGUgY3VycmVudCBuYW1lXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5kZXNjcmlwdGlvbjsgLy8gUHJlLWZpbGwgdGhlIGZvcm0gd2l0aCB0aGUgY3VycmVudCBkZXNjcmlwdGlvblxyXG5cclxuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTsgLy8gUmVzZXQgdmFsaWRhdGlvbiBzdGF0ZSBmb3IgdGhlIGZvcm1cclxuICBwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2Uub3BlbigpOyAvLyBPcGVuIHRoZSBwb3B1cFxyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBvcGVuIHRoZSBpbWFnZSBwb3B1cCB3aXRoIHRoZSBwcm92aWRlZCBpbWFnZSBsaW5rIGFuZCBuYW1lXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlUG9wdXAobGluaywgbmFtZSkge1xyXG4gIHBpY3R1cmVQb3B1cEluc3RhbmNlLm9wZW4oeyBuYW1lLCBsaW5rIH0pOyAvLyBQYXNzIHRoZSBpbWFnZSBkYXRhIHRvIHRoZSBwb3B1cCBpbnN0YW5jZVxyXG59XHJcblxyXG4vLyBJbml0aWFsaXplIHRoZSBwcm9maWxlIGVkaXQgcG9wdXAgd2l0aCBmb3JtIGhhbmRsaW5nXHJcbmNvbnN0IHByb2ZpbGVFZGl0UG9wdXBJbnN0YW5jZSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1wb3B1cFwiLFxyXG4gIChmb3JtRGF0YSkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC51cGRhdGVVc2VySW5mbyhmb3JtRGF0YSkgLy8gQVBJIGNhbGwgdG8gdXBkYXRlIHVzZXIgaW5mb1xyXG4gICAgICAudGhlbigodXBkYXRlZFVzZXJJbmZvKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm9JbnN0YW5jZS5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVkVXNlckluZm8ubmFtZSxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVkVXNlckluZm8uYWJvdXQsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcHJvZmlsZUVkaXRQb3B1cEluc3RhbmNlLmNsb3NlKCk7IC8vIENsb3NlIHRoZSBwb3B1cCBhZnRlciBzdWJtaXNzaW9uXHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgcHJvZmlsZTpcIiwgZXJyKSk7XHJcbiAgfVxyXG4pO1xyXG5wcm9maWxlRWRpdFBvcHVwSW5zdGFuY2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHBvcHVwXHJcblxyXG4vLyBJbml0aWFsaXplIHRoZSBhZGQgY2FyZCBwb3B1cCB3aXRoIGZvcm0gaGFuZGxpbmdcclxuY29uc3QgYWRkQ2FyZFBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhZGQtY2FyZC1wb3B1cFwiLFxyXG4gIChmb3JtRGF0YSkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5hZGRDYXJkKGZvcm1EYXRhKSAvLyBBUEkgY2FsbCB0byBhZGQgYSBuZXcgY2FyZFxyXG4gICAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChuZXdDYXJkKTsgLy8gQ3JlYXRlIHRoZSBuZXcgY2FyZFxyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpOyAvLyBBZGQgaXQgdG8gdGhlIHNlY3Rpb25cclxuICAgICAgICBhZGRDYXJkUG9wdXBJbnN0YW5jZS5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgcG9wdXAgYWZ0ZXIgc3VibWlzc2lvblxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBjYXJkOlwiLCBlcnIpKTtcclxuICB9XHJcbik7XHJcbmFkZENhcmRQb3B1cEluc3RhbmNlLnNldEV2ZW50TGlzdGVuZXJzKCk7IC8vIFNldCB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBwb3B1cFxyXG5cclxuLy8gSW5pdGlhbGl6ZSB0aGUgYXZhdGFyIGVkaXQgcG9wdXAgd2l0aCBmb3JtIGhhbmRsaW5nXHJcbmNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYXZhdGFyLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYXZhdGFyLWVkaXQtcG9wdXBcIiwgKGZvcm1EYXRhKSA9PiB7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKGZvcm1EYXRhLmF2YXRhcikgLy8gQVBJIGNhbGwgdG8gdXBkYXRlIHRoZSBhdmF0YXJcclxuICAgIC50aGVuKCh1cGRhdGVkVXNlckluZm8pID0+IHtcclxuICAgICAgLy8gVXBkYXRlIHRoZSBhdmF0YXIgaW4gdGhlIERPTVxyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpLnNyYyA9IHVwZGF0ZWRVc2VySW5mby5hdmF0YXI7XHJcbiAgICAgIGF2YXRhckVkaXRQb3B1cC5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgcG9wdXAgYWZ0ZXIgc3VibWlzc2lvblxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnIpKTtcclxufSk7XHJcblxyXG4vLyBTZXQgdXAgdGhlIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgYXZhdGFyIGVkaXQgYnV0dG9uXHJcbmF2YXRhckVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJFZGl0UG9wdXAub3BlbigpOyAvLyBPcGVuIHRoZSBwb3B1cCB0byBlZGl0IGF2YXRhclxyXG59KTtcclxuYXZhdGFyRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7IC8vIFNldCB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBhdmF0YXIgcG9wdXBcclxuXHJcbi8vIEluaXRpYWxpemUgdGhlIGltYWdlIHBvcHVwIGZvciBkaXNwbGF5aW5nIGxhcmdlciBpbWFnZXNcclxuY29uc3QgcGljdHVyZVBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcGljdHVyZS1wb3B1cFwiKTtcclxucGljdHVyZVBvcHVwSW5zdGFuY2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHBvcHVwXHJcblxyXG4vLyBJbml0aWFsaXplIGZvcm0gdmFsaWRhdG9ycyBmb3IgdGhlIHByb2ZpbGUgYW5kIGNhcmQgZm9ybXNcclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBmb3JtVmFsaWRhdGlvblNldHRpbmdzLFxyXG4gIHByb2ZpbGVFZGl0Rm9ybVxyXG4pO1xyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgYWRkQ2FyZEZvcm1cclxuKTtcclxuXHJcbi8vIEVuYWJsZSBmb3JtIHZhbGlkYXRpb24gZm9yIGJvdGggZm9ybXNcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgcHJvZmlsZSBlZGl0IGFuZCBhZGQgY2FyZCBidXR0b25zXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVQcm9maWxlRWRpdCk7XHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXBJbnN0YW5jZS5vcGVuKCk7IC8vIE9wZW4gdGhlIGFkZCBjYXJkIHBvcHVwIHdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkXHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgLy8gQ29uc3RydWN0b3IgaW5pdGlhbGl6ZXMgdGhlIGNsYXNzIHdpdGggdGhlIHNlbGVjdG9ycyBmb3IgdGhlIG5hbWUgYW5kIGRlc2NyaXB0aW9uIGVsZW1lbnRzXHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IgfSkge1xyXG4gICAgLy8gR2V0IHRoZSBET00gZWxlbWVudCBmb3IgdGhlIHVzZXIncyBuYW1lIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBzZWxlY3RvclxyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcblxyXG4gICAgLy8gR2V0IHRoZSBET00gZWxlbWVudCBmb3IgdGhlIHVzZXIncyBkZXNjcmlwdGlvbiBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgc2VsZWN0b3JcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyBNZXRob2QgdG8gZ2V0IHRoZSBjdXJyZW50IHVzZXIgaW5mb3JtYXRpb24gKG5hbWUgYW5kIGRlc2NyaXB0aW9uKSBmcm9tIHRoZSBET01cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIC8vIFJldHVybiBhbiBvYmplY3QgY29udGFpbmluZyB0aGUgY3VycmVudCBuYW1lIGFuZCBkZXNjcmlwdGlvbiB0ZXh0IGZyb20gdGhlIERPTSBlbGVtZW50c1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsIC8vIEdldCB0aGUgbmFtZSBmcm9tIHRoZSBET00gZWxlbWVudFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LCAvLyBHZXQgdGhlIGRlc2NyaXB0aW9uIGZyb20gdGhlIERPTSBlbGVtZW50XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gTWV0aG9kIHRvIHVwZGF0ZSB0aGUgdXNlcidzIGluZm9ybWF0aW9uIGluIHRoZSBET01cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIC8vIFVwZGF0ZSB0aGUgRE9NIGVsZW1lbnQgd2l0aCB0aGUgbmV3IG5hbWVcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIERPTSBlbGVtZW50IHdpdGggdGhlIG5ldyBkZXNjcmlwdGlvblxyXG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pOyAvLyBSZW5kZXIgZWFjaCBpdGVtIGFuZCBhZGQgaXQgdG8gdGhlIGNvbnRhaW5lciB2aWEgdGhlIHJlbmRlcmVyXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0ocmVuZGVyZWRJdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChyZW5kZXJlZEl0ZW0pOyAvLyBBZGQgdGhlIHJlbmRlcmVkIGl0ZW0gdG8gdGhlIHRvcCBvZiB0aGUgY29udGFpbmVyXHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXB0aW9uRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7IC8vIFNldCB0aGUgaW1hZ2UgVVJMXHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTsgLy8gU2V0IHRoZSBpbWFnZSBhbHQgdGV4dFxyXG4gICAgdGhpcy5fY2FwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lOyAvLyBTZXQgdGhlIGNhcHRpb24gdGV4dFxyXG4gICAgc3VwZXIub3BlbigpOyAvLyBPcGVuIHRoZSBwb3B1cFxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZm9ybVZhbGlkYXRpb25TZXR0aW5ncyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJzZWxlY3RvcnMiLCJwcm9maWxlRWRpdEZvcm0iLCJkb2N1bWVudCIsImZvcm1zIiwiYWRkQ2FyZEZvcm0iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRDYXJkQnV0dG9uIiwicHJvZmlsZUVkaXRQb3B1cCIsImFkZENhcmRQb3B1cCIsInBpY3R1cmVQb3B1cCIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTGlzdEVsIiwiYWRkQ2FyZFRpdGxlSW5wdXQiLCJhZGRDYXJkVXJsSW5wdXQiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsIm5hbWUiLCJsaW5rIiwiX2lkIiwibGlrZXMiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9saWtlcyIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9jcmVhdGVDYXJkRWxlbWVudCIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkRWxlbWVudCIsIl9saWtlQnV0dG9uIiwiX3RyYXNoQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiX2NhcmRUaXRsZUVsIiwiX2xpa2VDb3VudEVsIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfc2V0TGlrZVN0YXRlIiwic29tZSIsInVzZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaXNMaWtlZCIsInJlbW92ZSIsImxlbmd0aCIsIl90b2dnbGVMaWtlIiwiYXBpIiwiZGlzbGlrZUNhcmQiLCJ0aGVuIiwidXBkYXRlZENhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImxpa2VDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZURlbGV0ZUNhcmQiLCJnZXRWaWV3IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mb0luc3RhbmNlIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJfcmVmMiIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsImhhbmRsZUltYWdlUG9wdXAiLCJjYXJkU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicmVuZGVyZWRJdGVtIiwicHJlcGVuZCIsInBpY3R1cmVQb3B1cEluc3RhbmNlIiwidXNlckluZm8iLCJhYm91dCIsImdldEluaXRpYWxDYXJkcyIsImNhcmRzIiwicHJvZmlsZUVkaXRQb3B1cEluc3RhbmNlIiwiZm9ybURhdGEiLCJ1cGRhdGVVc2VySW5mbyIsInVwZGF0ZWRVc2VySW5mbyIsImFkZENhcmRQb3B1cEluc3RhbmNlIiwiYWRkQ2FyZCIsIm5ld0NhcmQiLCJhdmF0YXJFZGl0QnV0dG9uIiwiYXZhdGFyRWRpdFBvcHVwIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwiX2ltYWdlRWxlbWVudCIsIl9jYXB0aW9uRWxlbWVudCIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJ1c2VyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=